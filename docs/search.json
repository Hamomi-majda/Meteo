[
  {
    "objectID": "meteo.html",
    "href": "meteo.html",
    "title": "Meteo",
    "section": "",
    "text": "import numpy as np\n\nimport requests\nimport datetime\nfrom dateutil.relativedelta import relativedelta\n\n# initialisation des dates de debut et fin d'extraction de données\ndate_debut = datetime.datetime.now() - relativedelta(days=2)\ndate_fin = date_debut + relativedelta(days=6)\n# formatage des dates pour importer le bon URL\ndate_debut_formattee = date_debut.strftime('%Y-%m-%d') \ndate_fin_formattee = date_fin.strftime('%Y-%m-%d')  \n\n# copie de l'URL du site open-meteo avec les differents critères qui nous interessent\nurl = f\"https://api.open-meteo.com/v1/meteofrance?latitude=43.6109&longitude=3.8763&hourly=temperature_2m,weathercode,precipitation&daily=weathercode,temperature_2m_max,temperature_2m_min,wind_speed_10m_max,precipitation_sum&timezone=Europe%2FLondon&start_date={date_debut_formattee}&end_date={date_fin_formattee}\"\n\n# récuperation des données\nresponse = requests.get(url)\ndata = response.json()\n\n# initialisation des tableaux de données\ntemp = data[\"hourly\"][\"temperature_2m\"]\nprecipitation = data[\"daily\"][\"precipitation_sum\"]\nprecipitation_h = data[\"hourly\"][\"precipitation\"]\nwind = data[\"daily\"][\"wind_speed_10m_max\"]\ntempmin = data[\"daily\"][\"temperature_2m_min\"]\ntempmax = data[\"daily\"][\"temperature_2m_max\"]\nicon = data[\"daily\"][\"weathercode\"]\n\ndef date(i):\n    \n    d = datetime.datetime.now() + relativedelta(days=i)\n    return f\"{d.day}-{d.month}-{d.year}\"\n\ndef index(i):\n    \n    jours_semaine = [\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\", \"Sunday\"]\n    return jours_semaine[(datetime.datetime.now().weekday() + i) % 7]  \ndef iconkey(i):\n    \"\"\"\n    Association de chaque code WBO à un pictogramme correspondant. Retourne le chemin d'accès au pictogramme par une chaîne de caractères. Version daily.\n    \"\"\"\n    code = icon[i]\n\n    if code == 0:\n        return \"icon/wi-day-sunny.svg\"\n    elif code == 1:\n        return \"icon/wi-day-sunny-overcast.svg\"\n    elif code == 2:\n        return \"icon/wi-day-cloudy.svg\"\n    elif code == 3:\n        return \"icon/wi-cloud.svg\"\n    elif code in [45, 48]:\n        return \"icon/wi-fog.svg\"\n    elif code in [51, 53, 55, 56, 57]:\n        return \"icon/wi-sprinkle.svg\"\n    elif code in [61, 81, 82]:\n        return \"icon/wi-showers.svg\"\n    elif code == 63:\n        return \"icon/wi-rain-wind.svg\"\n    elif code in [65, 66, 67]:\n        return \"icon/wi-rain.svg\"\n    elif code in [71, 73, 75, 85, 86]:\n        return \"icon/wi-snow.svg\"\n    elif code in [95, 96]:\n        return \"icon/wi-storm-showers.svg\"\n    elif code == 99:\n        return \"icon/wi-thunderstorm.svg\"\n    else:\n        return \"icon/wi-moon-new.svg\"\n\ndef iconrain(i):\n    \n    \"\"\"\n    Retourne une image sous format HTML correspondant à l'intensité des précipitations.\n    \"\"\"\n    if not isinstance(precipitation[i], float):\n        return \"\"\n\n    intensity = precipitation[i]\n\n    if 0 &lt; intensity &lt;= 2:\n        return f'&lt;img src=\"icon/wi-raindrop.svg\" width=\"20\" height=\"20\" /&gt;'\n    elif intensity &gt; 2:\n        return f'&lt;img src=\"icon/wi-raindrops.svg\" width=\"40\" height=\"40\" /&gt;'\n    else:\n        return \"\"  \n# Calcule la somme des 24 dernières valeurs de precipitation_h\nprecipitation_h = [0 if value is None else value for value in precipitation_h]\nprecipitationd = sum(precipitation_h[-24:])        \nfrom IPython.display import HTML\nfrom tabulate import tabulate\nres = f\"\"\"\n&lt;table class= \"table1-style\"&gt;\n    &lt;thead&gt;\n    &lt;tr&gt;  \n        &lt;th  style=\"border-top-left-radius : 20px 20px\"&gt; Days &lt;/th&gt;\n        &lt;th&gt;  {index(-2)} &lt;br&gt; &lt;small&gt; {date(-2)} &lt;/small&gt;&lt;/th&gt;\n        &lt;th&gt;  {index(-1)} &lt;br&gt; &lt;small&gt;{date(-1)}&lt;/small&gt;&lt;/th&gt;\n        &lt;th style=\"border-top:3px solid rgb(85, 215, 195,0.5);border-right:3px solid rgb(85, 215, 195,0.5);border-left:3px solid rgb(85, 215, 195,0.5)\"&gt;   &lt;a  style=\"text-decoration:none\"&gt; Today &lt;br&gt; &lt;small&gt;{date(0)}&lt;/small&gt; &lt;/a&gt;&lt;/th&gt;\n        &lt;th&gt;  {index(1)} &lt;br&gt; &lt;small&gt;{date(1)}&lt;/small&gt;&lt;/th&gt;\n        &lt;th&gt;  {index(2)} &lt;br&gt; &lt;small&gt;{date(2)}&lt;/small&gt;&lt;/th&gt;\n        &lt;th&gt;  {index(3)} &lt;br&gt; &lt;small&gt;{date(3)}&lt;/small&gt;&lt;/th&gt;\n        &lt;th  style=\"border-top-right-radius : 20px 20px\" &gt;  {index(4)} &lt;br&gt; &lt;small&gt;{date(4)}&lt;/small&gt;&lt;/th&gt;\n    &lt;/tr&gt;\n    &lt;/thead&gt;\n    &lt;tbody&gt;\n    &lt;tr&gt; \n        &lt;td&gt;  &lt;/td&gt;\n        &lt;td&gt; &lt;img src={iconkey(0)} width=\"50\"\n  height=\"50\" /&gt; &lt;/td&gt;\n        &lt;td&gt; &lt;img src={iconkey(1)} width=\"50\"\n  height=\"50\" /&gt; &lt;/td&gt;\n        &lt;td style=\"border-right:3px solid rgb(85, 215, 195,0.5);border-left:3px solid rgb(85, 215, 195,0.5)\"&gt; &lt;img src={iconkey(2)} width=\"50\"\n  height=\"50\" /&gt; &lt;/td&gt;\n        &lt;td&gt; &lt;img src={iconkey(3)} width=\"50\"\n  height=\"50\" /&gt; &lt;/td&gt;\n        &lt;td&gt; &lt;img src={iconkey(4)} width=\"50\"\n  height=\"50\" /&gt; &lt;/td&gt;\n        &lt;td&gt; &lt;img src={iconkey(5)} width=\"50\"\n  height=\"50\" /&gt; &lt;/td&gt;\n        &lt;td&gt; &lt;img src={iconkey(6)} width=\"50\"\n  height=\"50\" /&gt; &lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt; \n        &lt;td&gt; Temp Max (°C) &lt;/td&gt;\n        &lt;td style =\" background-color : rgba(255, 165, 80, 0.5); font-weight: bold;\" &gt; {tempmax[0]}°C &lt;/td&gt;\n        &lt;td style =\" background-color : rgba(255, 165, 80, 0.5);font-weight: bold;\" &gt; {tempmax[1]}°C &lt;/td&gt;\n        &lt;td style =\" background-color : rgba(255, 165, 80, 0.5);font-weight: bold;border-right:3px solid rgb(85, 215, 195,0.5);border-left:3px solid rgb(85, 215, 195,0.5)\" &gt; {tempmax[2]}°C &lt;/td&gt;\n        &lt;td style =\" background-color : rgba(255, 165, 80, 0.5);font-weight: bold;\" &gt; {tempmax[3]}°C &lt;/td&gt;\n        &lt;td style =\" background-color : rgba(255, 165, 80, 0.5);font-weight: bold;\" &gt; {tempmax[4]}°C &lt;/td&gt;\n        &lt;td style =\" background-color : rgba(255, 165, 80, 0.5);font-weight: bold;\" &gt; {tempmax[5]}°C &lt;/td&gt;\n        &lt;td style =\" background-color : rgba(255, 165, 80, 0.5);font-weight: bold;\" &gt; {tempmax[6]}°C &lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr &gt; \n        &lt;td&gt;  Temp Min (°C) &lt;/td&gt;\n        &lt;td style =\" background-color : rgba(144, 238, 144, 0.5);font-weight: bold;\" &gt; {tempmin[0]}°C &lt;/td&gt;\n        &lt;td style =\" background-color : rgba(144, 238, 144, 0.5);font-weight: bold;\" &gt; {tempmin[1]}°C &lt;/td&gt;\n        &lt;td style =\" background-color : rgba(144, 238, 144, 0.5);font-weight: bold;border-right:3px solid rgb(85, 215, 195,0.5);border-left:3px solid rgb(85, 215, 195,0.5)\" &gt; {tempmin[2]}°C &lt;/td&gt;\n        &lt;td style =\" background-color : rgba(144, 238, 144, 0.5);font-weight: bold;\" &gt; {tempmin[3]}°C &lt;/td&gt;\n        &lt;td style =\" background-color : rgba(144, 238, 144, 0.5);font-weight: bold;\" &gt; {tempmin[4]}°C &lt;/td&gt;\n        &lt;td style =\" background-color : rgba(144, 238, 144, 0.5);font-weight: bold;\" &gt; {tempmin[5]}°C &lt;/td&gt;\n        &lt;td style =\" background-color : rgba(144, 238, 144, 0.5);font-weight: bold;\" &gt; {tempmin[6]}°C &lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt; \n        &lt;td&gt; Wind Speed Max  &lt;/td&gt;\n        &lt;td&gt; {int(wind[0])} km/h &lt;/td&gt;\n        &lt;td&gt; {int(wind[1])} km/h &lt;/td&gt;\n        &lt;td style=\"border-right:3px solid rgb(85, 215, 195,0.5);border-left:3px solid rgb(85, 215, 195,0.5)\"&gt; {int(wind[2])} km/h &lt;/td&gt;\n        &lt;td&gt; {int(wind[3])} km/h &lt;/td&gt;\n        &lt;td&gt; {int(wind[4])} km/h &lt;/td&gt;\n        &lt;td&gt; {int(wind[5])} km/h &lt;/td&gt;\n        &lt;td&gt; {int(wind[6])} km/h &lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt; \n        &lt;td style=\"border-bottom-left-radius : 20px 20px\"&gt; Precipitation &lt;/td&gt;\n        &lt;td&gt; {iconrain(0)} {precipitation[0]} mm &lt;/td&gt;\n        &lt;td&gt; {iconrain(1)} {precipitation [1]} mm &lt;/td&gt;\n        &lt;td style=\"border-bottom:3px solid rgb(85, 215, 195,0.5);border-right:3px solid rgb(85, 215, 195,0.5);border-left:3px solid rgb(85, 215, 195,0.5)\"&gt; {iconrain(2)} {precipitation[2]} mm &lt;/td&gt;\n        &lt;td&gt; {iconrain(3)} {precipitation[3]} mm &lt;/td&gt;\n        &lt;td&gt; {iconrain(4)} {precipitation[4]} mm &lt;/td&gt;\n        &lt;td&gt; {iconrain(5)} {precipitation[5]} mm &lt;/td&gt;\n        &lt;td style=\"border-bottom-right-radius : 20px 20px\"&gt; {iconrain(6)} {precipitationd} mm &lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;/tbody&gt;\n\n&lt;/table&gt;\n\"\"\"\nHTML(res)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nDays\nSunday\n12-11-2023\nMonday\n13-11-2023\nToday\n14-11-2023\nWednesday\n15-11-2023\nThursday\n16-11-2023\nFriday\n17-11-2023\nSaturday\n18-11-2023\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTemp Max (°C)\n18.9°C\n20.3°C\n24.3°C\n18.8°C\n14.3°C\n16.1°C\n16.6°C\n\n\nTemp Min (°C)\n8.2°C\n13.1°C\n15.0°C\n10.5°C\n8.0°C\n8.7°C\n5.8°C\n\n\nWind Speed Max\n20 km/h\n8 km/h\n23 km/h\n23 km/h\n9 km/h\n28 km/h\n9 km/h\n\n\nPrecipitation\n 3.1 mm\n0.0 mm\n0.0 mm\n0.0 mm\n 0.1 mm\n0.0 mm\n0.0 mm"
  }
]